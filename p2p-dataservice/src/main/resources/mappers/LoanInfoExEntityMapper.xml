<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.bob.p2p.dao.loan.LoanInfoExEntityMapper" >
    <resultMap id="loanInfoExEntity" type="com.bob.p2p.model.loan.LoanInfoEntity" extends="com.bob.p2p.dao.LoanInfoEntityMapper.BaseResultMap">


    </resultMap>

    <!-- 查询历史年化收益率 -->
  <select id="selectHistoryAverageRate" resultType="java.lang.Double">
    select cast(avg(rate) as Decimal (10,2)) from b_loan_info;
  </select>

    <!-- 按照类型查询产品 -->
  <select id="selectLoanInfoByProductType" resultMap="loanInfoExEntity">
    select
        <include refid="com.bob.p2p.dao.LoanInfoEntityMapper.Base_Column_List"/>
    from b_loan_info
     <where>
       <if test="productType != null">
               product_type = #{productType}
      </if>
     </where>
    order by release_time desc
    limit #{currentPage},#{pageSize};
  </select>

    <!--  查询产品总数  -->
    <select id="selectLoanInfoToltal" resultType="java.lang.Long">
        select count(id)
        from
            b_loan_info
        <where>
            <if test="productType != null">
                product_type = #{productType}
            </if>
        </where>
    </select>
</mapper>